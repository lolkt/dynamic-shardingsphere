dataSources:
  ds-master: !!com.zaxxer.hikari.HikariDataSource
    driverClassName: com.mysql.cj.jdbc.Driver
    jdbcUrl: jdbc:mysql://localhost:3306/test_master
    username: root
    password: 123456
  ds-master-0: !!com.zaxxer.hikari.HikariDataSource
    driverClassName: com.mysql.cj.jdbc.Driver
    jdbcUrl: jdbc:mysql://localhost:3306/test_shard_01
    username: root
    password: 123456
  ds-master-1: !!com.zaxxer.hikari.HikariDataSource
    driverClassName: com.mysql.cj.jdbc.Driver
    jdbcUrl: jdbc:mysql://localhost:3306/test_shard_02
    username: root
    password: 123456
  ds-slave: !!com.zaxxer.hikari.HikariDataSource
    driverClassName: com.mysql.cj.jdbc.Driver
    jdbcUrl: jdbc:mysql://localhost:3306/test_slave
    username: root
    password: 123456

shardingRule:

  # 默认数据源，未分片的表默认执行库
  defaultDataSourceName: ds
  defaultDatabaseStrategy:
    inline:
      shardingColumn: customer_id
      algorithmExpression: ds$->{customer_id % 2}
  defaultTableStrategy:
    none:

  tables:
    # tm_customer单独分库策略，以主键id为分片键，分库策略为id % 8
    t_customer:
      actualDataNodes: ds$->{0..1}.t_customer
      databaseStrategy:
        inline:
          shardingColumn: id
          algorithmExpression: ds$->{id % 2}

    t_order:
      actualDataNodes: ds.t_order_${0..1}
      databaseStrategy:
        none: # 不分片
      tableStrategy:
        inline:
          shardingColumn: customer_id
          algorithmExpression: t_order_${customer_id % 2}

  # 读写分离
  masterSlaveRules:
    ds:
      masterDataSourceName: ds-master
      slaveDataSourceNames: [ds-slave]
    ds0:
      masterDataSourceName: ds-master-0
      slaveDataSourceNames: [ds-master-0]
    ds1:
      masterDataSourceName: ds-master-1
      slaveDataSourceNames: [ds-master-1]

props:
  sql.show: true
